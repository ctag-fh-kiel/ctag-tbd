// AjaxQ jQuery Plugin
// Copyright (c) 2012 Foliotek Inc.
// MIT License
// https://github.com/Foliotek/ajaxq
!function(e){var t={},n={};e.ajaxq=function(r,a){if(void 0===a)throw"AjaxQ: queue name is not provided";var i=e.Deferred(),u=i.promise();u.success=u.done,u.error=u.fail,u.complete=u.always;var o=e.extend(!0,{},a);return function(e){if(t[r])t[r].push(e);else{t[r]=[];var a=e();n[r]=a}}(function(){var t=e.ajax.apply(window,[o]);return t.done(function(){i.resolve.apply(this,arguments)}),t.fail(function(){i.reject.apply(this,arguments)}),t.always(f),t}),u;function f(){if(t[r]){var e=t[r].shift();if(e){var a=e();n[r]=a}else delete t[r],delete n[r]}}},e.each(["getq","postq"],function(t,n){e[n]=function(t,r,a,i,u){return e.isFunction(a)&&(u=u||i,i=a,a=void 0),e.ajaxq(t,{type:"postq"===n?"post":"get",url:r,data:a,success:i,dataType:u})}});var r=function(e){return t.hasOwnProperty(e)};e.ajaxq.isRunning=function(e){return e?r(e):function(){for(var e in t)if(r(e))return!0;return!1}()},e.ajaxq.getActiveRequest=function(e){if(!e)throw"AjaxQ: queue name is required";return n[e]},e.ajaxq.abort=function(r){if(!r)throw"AjaxQ: queue name is required";var a=e.ajaxq.getActiveRequest(r);delete t[r],delete n[r],a&&a.abort()},e.ajaxq.clear=function(e){if(e)t[e]&&(t[e]=[]);else for(var n in t)t.hasOwnProperty(n)&&(t[n]=[])}}(jQuery);